---
description: "环境变量配置规范和使用说明"
globs:
  - "**/env.ts"
  - "**/.dev.vars*"
  - "**/wrangler.toml"
---

# 环境变量规范

## 必需的环境变量

### 阿里云 OSS 配置
- `ALIYUN_OSS_ACCESS_KEY_ID`: 阿里云 OSS AccessKey ID
- `ALIYUN_OSS_ACCESS_KEY_SECRET`: 阿里云 OSS AccessKey Secret
- `ALIYUN_OSS_REGION`: 阿里云 OSS 区域（如：oss-cn-hangzhou）
- `ALIYUN_OSS_BUCKET`: 阿里云 OSS 存储桶名称

### 钉钉应用配置
- `DINGTALK_APP_KEY`: 钉钉应用 AppKey
- `DINGTALK_APP_SECRET`: 钉钉应用 AppSecret
- `DINGTALK_REDIRECT_URI`: 钉钉登录回调地址

### 其他配置
- `SESSION_SECRET`: 会话加密密钥（用于生成 session token，建议 32 位以上随机字符串）

## 环境变量使用规范

1. **统一验证**: 使用 `src/utils/env.ts` 中的 `validateEnv()` 函数验证所有必需的环境变量
2. **类型安全**: 使用 `src/types/env.d.ts` 中的 `Env` 接口定义环境变量类型
3. **开发环境**: 使用 `.dev.vars` 文件配置开发环境变量（不要提交到 Git）
4. **生产环境**: 使用 Wrangler secrets 管理生产环境密钥：
   ```bash
   npx wrangler secret put VARIABLE_NAME
   ```
5. **获取变量**: 使用 `getEnvVar()` 函数获取环境变量（带默认值支持）

## 环境变量配置示例

参考 `.dev.vars.example` 文件，包含所有必需的环境变量模板。
